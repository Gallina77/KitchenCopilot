import streamlit as st
from sqlalchemy import text

conn = st.connection('kitchencopilot_db', type='sql')
##Seed data for predictions table
## Generated for last 6 months with German weather and holidays
with conn.session as session:
    session.execute(text('DELETE FROM predictions;'))
    session.commit()
    
#     session.execute(text("""INSERT INTO predictions (date, weekday, month, expected_capacity, temperature_max,
#             weather_condition, is_bank_holiday, is_bridge_day, is_semester_break,
#             holiday_desc, predicted_meals, prediction_timestamp) VALUES
#             ('2025-07-09', 'Tuesday', 'July', 331, 20.0, 'Sunny', FALSE, FALSE, FALSE, '', 299, '2025-07-02 00:00:00'),
#             ('2025-07-10', 'Wednesday', 'July', 318, 27.1, 'Cloudy', FALSE, FALSE, FALSE, '', 278, '2025-07-03 00:00:00'),
#             ('2025-07-11', 'Thursday', 'July', 330, 22.8, 'Cloudy', FALSE, FALSE, FALSE, '', 286, '2025-07-04 00:00:00'),
#             ('2025-07-12', 'Friday', 'July', 270, 25.3, 'Cloudy', FALSE, FALSE, FALSE, '', 227, '2025-07-05 00:00:00'),
#             ('2025-07-15', 'Monday', 'July', 199, 21.4, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 164, '2025-07-08 00:00:00'),
#             ('2025-07-16', 'Tuesday', 'July', 182, 18.8, 'Sunny', FALSE, FALSE, TRUE, '', 163, '2025-07-09 00:00:00'),
#             ('2025-07-17', 'Wednesday', 'July', 216, 18.9, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 182, '2025-07-10 00:00:00'),
#             ('2025-07-18', 'Thursday', 'July', 205, 21.0, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 157, '2025-07-11 00:00:00'),
#             ('2025-07-19', 'Friday', 'July', 192, 20.6, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 154, '2025-07-12 00:00:00'),
#             ('2025-07-22', 'Monday', 'July', 200, 19.3, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 155, '2025-07-15 00:00:00'),
#             ('2025-07-23', 'Tuesday', 'July', 203, 19.5, 'Sunny', FALSE, FALSE, TRUE, '', 158, '2025-07-16 00:00:00'),
#             ('2025-07-24', 'Wednesday', 'July', 231, 24.2, 'Rain', FALSE, FALSE, TRUE, '', 195, '2025-07-17 00:00:00'),
#             ('2025-07-25', 'Thursday', 'July', 191, 22.7, 'Rain', FALSE, FALSE, TRUE, '', 169, '2025-07-18 00:00:00'),
#             ('2025-07-26', 'Friday', 'July', 150, 22.4, 'Rain', FALSE, FALSE, TRUE, '', 132, '2025-07-19 00:00:00'),
#             ('2025-07-29', 'Monday', 'July', 182, 22.4, 'Rain', FALSE, FALSE, TRUE, '', 151, '2025-07-22 00:00:00'),
#             ('2025-07-30', 'Tuesday', 'July', 199, 21.5, 'Sunny', FALSE, FALSE, TRUE, '', 161, '2025-07-23 00:00:00'),
#             ('2025-07-31', 'Wednesday', 'July', 219, 23.0, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 179, '2025-07-24 00:00:00'),
#             ('2025-08-01', 'Thursday', 'August', 207, 25.9, 'Sunny', FALSE, FALSE, TRUE, '', 147, '2025-07-25 00:00:00'),
#             ('2025-08-02', 'Friday', 'August', 150, 22.6, 'Rain', FALSE, FALSE, TRUE, '', 120, '2025-07-26 00:00:00'),
#             ('2025-08-05', 'Monday', 'August', 169, 19.0, 'Sunny', FALSE, FALSE, TRUE, '', 143, '2025-07-29 00:00:00'),
#             ('2025-08-06', 'Tuesday', 'August', 187, 25.1, 'Rain', FALSE, FALSE, TRUE, '', 175, '2025-07-30 00:00:00'),
#             ('2025-08-07', 'Wednesday', 'August', 211, 19.8, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 185, '2025-07-31 00:00:00'),
#             ('2025-08-08', 'Thursday', 'August', 190, 17.3, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 158, '2025-08-01 00:00:00'),
#             ('2025-08-09', 'Friday', 'August', 180, 22.3, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 134, '2025-08-02 00:00:00'),
#             ('2025-08-12', 'Monday', 'August', 208, 23.5, 'Sunny', FALSE, FALSE, TRUE, '', 149, '2025-08-05 00:00:00'),
#             ('2025-08-13', 'Tuesday', 'August', 217, 25.6, 'Cloudy', FALSE, FALSE, TRUE, '', 195, '2025-08-06 00:00:00'),
#             ('2025-08-14', 'Wednesday', 'August', 212, 21.7, 'Sunny', FALSE, FALSE, TRUE, '', 172, '2025-08-07 00:00:00'),
#             ('2025-08-15', 'Thursday', 'August', 222, 24.4, 'Rain', FALSE, FALSE, TRUE, '', 176, '2025-08-08 00:00:00'),
#             ('2025-08-16', 'Friday', 'August', 186, 25.3, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 150, '2025-08-09 00:00:00'),
#             ('2025-08-19', 'Monday', 'August', 207, 22.3, 'Sunny', FALSE, FALSE, TRUE, '', 152, '2025-08-12 00:00:00'),
#             ('2025-08-20', 'Tuesday', 'August', 209, 22.2, 'Cloudy', FALSE, FALSE, TRUE, '', 188, '2025-08-13 00:00:00'),
#             ('2025-08-21', 'Wednesday', 'August', 174, 22.5, 'Sunny', FALSE, FALSE, TRUE, '', 143, '2025-08-14 00:00:00'),
#             ('2025-08-22', 'Thursday', 'August', 168, 19.7, 'Sunny', FALSE, FALSE, TRUE, '', 134, '2025-08-15 00:00:00'),
#             ('2025-08-23', 'Friday', 'August', 190, 18.1, 'Cloudy', FALSE, FALSE, TRUE, '', 137, '2025-08-16 00:00:00'),
#             ('2025-08-26', 'Monday', 'August', 216, 17.4, 'Sunny', FALSE, FALSE, TRUE, '', 166, '2025-08-19 00:00:00'),
#             ('2025-08-27', 'Tuesday', 'August', 199, 26.3, 'Cloudy', FALSE, FALSE, TRUE, '', 168, '2025-08-20 00:00:00'),
#             ('2025-08-28', 'Wednesday', 'August', 186, 20.2, 'Sunny', FALSE, FALSE, TRUE, '', 146, '2025-08-21 00:00:00'),
#             ('2025-08-29', 'Thursday', 'August', 203, 18.8, 'Sunny', FALSE, FALSE, TRUE, '', 171, '2025-08-22 00:00:00'),
#             ('2025-08-30', 'Friday', 'August', 156, 21.1, 'Sunny', FALSE, FALSE, TRUE, '', 107, '2025-08-23 00:00:00'),
#             ('2025-09-02', 'Monday', 'September', 199, 13.5, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 164, '2025-08-26 00:00:00'),
#             ('2025-09-03', 'Tuesday', 'September', 229, 14.8, 'Sunny', FALSE, FALSE, TRUE, '', 183, '2025-08-27 00:00:00'),
#             ('2025-09-04', 'Wednesday', 'September', 225, 21.0, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 203, '2025-08-28 00:00:00'),
#             ('2025-09-05', 'Thursday', 'September', 186, 16.4, 'Sunny', FALSE, FALSE, TRUE, '', 146, '2025-08-29 00:00:00'),
#             ('2025-09-06', 'Friday', 'September', 153, 19.7, 'Sunny', FALSE, FALSE, TRUE, '', 125, '2025-08-30 00:00:00'),
#             ('2025-09-09', 'Monday', 'September', 203, 17.1, 'Cloudy', FALSE, FALSE, TRUE, '', 181, '2025-09-02 00:00:00'),
#             ('2025-09-10', 'Tuesday', 'September', 221, 15.2, 'Cloudy', FALSE, FALSE, TRUE, '', 202, '2025-09-03 00:00:00'),
#             ('2025-09-11', 'Wednesday', 'September', 182, 15.3, 'Cloudy', FALSE, FALSE, TRUE, '', 158, '2025-09-04 00:00:00'),
#             ('2025-09-12', 'Thursday', 'September', 184, 15.1, 'Rain', FALSE, FALSE, TRUE, '', 150, '2025-09-05 00:00:00'),
#             ('2025-09-13', 'Friday', 'September', 167, 20.4, 'Sunny', FALSE, FALSE, TRUE, '', 131, '2025-09-06 00:00:00'),
#             ('2025-09-16', 'Monday', 'September', 193, 12.5, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 157, '2025-09-09 00:00:00'),
#             ('2025-09-17', 'Tuesday', 'September', 232, 18.4, 'Sunny', FALSE, FALSE, TRUE, '', 176, '2025-09-10 00:00:00'),
#             ('2025-09-18', 'Wednesday', 'September', 198, 15.1, 'Rain', FALSE, FALSE, TRUE, '', 161, '2025-09-11 00:00:00'),
#             ('2025-09-19', 'Thursday', 'September', 189, 18.5, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 169, '2025-09-12 00:00:00'),
#             ('2025-09-20', 'Friday', 'September', 173, 21.8, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 134, '2025-09-13 00:00:00'),
#             ('2025-09-23', 'Monday', 'September', 209, 15.9, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 169, '2025-09-16 00:00:00'),
#             ('2025-09-24', 'Tuesday', 'September', 205, 13.8, 'Rain', FALSE, FALSE, TRUE, '', 161, '2025-09-17 00:00:00'),
#             ('2025-09-25', 'Wednesday', 'September', 179, 15.3, 'Rain', FALSE, FALSE, TRUE, '', 168, '2025-09-18 00:00:00'),
#             ('2025-09-26', 'Thursday', 'September', 216, 14.3, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 169, '2025-09-19 00:00:00'),
#             ('2025-09-27', 'Friday', 'September', 186, 19.8, 'Sunny', FALSE, FALSE, TRUE, '', 149, '2025-09-20 00:00:00'),
#             ('2025-09-30', 'Monday', 'September', 189, 16.5, 'Sunny', FALSE, FALSE, TRUE, '', 168, '2025-09-23 00:00:00'),
#             ('2025-10-01', 'Tuesday', 'October', 217, 7.5, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 186, '2025-09-24 00:00:00'),
#             ('2025-10-02', 'Wednesday', 'October', 228, 15.0, 'Rain', FALSE, FALSE, TRUE, '', 211, '2025-09-25 00:00:00'),
#             ('2025-10-04', 'Friday', 'October', 150, 8.7, 'Cloudy', FALSE, TRUE, TRUE, '', 128, '2025-09-27 00:00:00'),
#             ('2025-10-07', 'Monday', 'October', 187, 12.6, 'Rain', FALSE, FALSE, TRUE, '', 161, '2025-09-30 00:00:00'),
#             ('2025-10-08', 'Tuesday', 'October', 184, 10.4, 'Cloudy', FALSE, FALSE, TRUE, '', 167, '2025-10-01 00:00:00'),
#             ('2025-10-09', 'Wednesday', 'October', 191, 13.3, 'Fog', FALSE, FALSE, TRUE, '', 146, '2025-10-02 00:00:00'),
#             ('2025-10-10', 'Thursday', 'October', 198, 13.4, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 161, '2025-10-03 00:00:00'),
#             ('2025-10-11', 'Friday', 'October', 154, 9.6, 'Rain', FALSE, FALSE, TRUE, '', 131, '2025-10-04 00:00:00'),
#             ('2025-10-14', 'Monday', 'October', 193, 9.3, 'Partly Cloudy', FALSE, FALSE, TRUE, '', 147, '2025-10-07 00:00:00'),
#             ('2025-10-15', 'Tuesday', 'October', 320, 9.3, 'Rain', FALSE, FALSE, FALSE, '', 301, '2025-10-08 00:00:00'),
#             ('2025-10-16', 'Wednesday', 'October', 318, 9.3, 'Cloudy', FALSE, FALSE, FALSE, '', 285, '2025-10-09 00:00:00'),
#             ('2025-10-17', 'Thursday', 'October', 347, 10.6, 'Cloudy', FALSE, FALSE, FALSE, '', 305, '2025-10-10 00:00:00'),
#             ('2025-10-18', 'Friday', 'October', 271, 15.0, 'Partly Cloudy', FALSE, FALSE, FALSE, '', 226, '2025-10-11 00:00:00'),
#             ('2025-10-21', 'Monday', 'October', 319, 10.6, 'Partly Cloudy', FALSE, FALSE, FALSE, '', 274, '2025-10-14 00:00:00'),
#             ('2025-10-22', 'Tuesday', 'October', 344, 13.0, 'Fog', FALSE, FALSE, FALSE, '', 282, '2025-10-15 00:00:00'),
#             ('2025-10-23', 'Wednesday', 'October', 321, 10.6, 'Cloudy', FALSE, FALSE, FALSE, '', 286, '2025-10-16 00:00:00'),
#             ('2025-10-24', 'Thursday', 'October', 317, 8.0, 'Cloudy', FALSE, FALSE, FALSE, '', 246, '2025-10-17 00:00:00'),
#             ('2025-10-25', 'Friday', 'October', 296, 13.6, 'Cloudy', FALSE, FALSE, FALSE, '', 228, '2025-10-18 00:00:00'),
#             ('2025-10-28', 'Monday', 'October', 309, 7.1, 'Partly Cloudy', FALSE, FALSE, FALSE, '', 259, '2025-10-21 00:00:00'),
#             ('2025-10-29', 'Tuesday', 'October', 369, 9.9, 'Rain', FALSE, FALSE, FALSE, '', 295, '2025-10-22 00:00:00'),
#             ('2025-10-30', 'Wednesday', 'October', 370, 9.9, 'Partly Cloudy', FALSE, FALSE, FALSE, '', 310, '2025-10-23 00:00:00'),
#             ('2025-10-31', 'Thursday', 'October', 333, 15.0, 'Cloudy', FALSE, FALSE, FALSE, '', 302, '2025-10-24 00:00:00'),
#             ('2025-11-01', 'Friday', 'November', 186, 5.1, 'Partly Cloudy', FALSE, TRUE, FALSE, '', 154, '2025-10-25 00:00:00'),
#             ('2025-11-04', 'Monday', 'November', 325, 4.9, 'Rain', FALSE, FALSE, FALSE, '', 279, '2025-10-28 00:00:00'),
#             ('2025-11-05', 'Tuesday', 'November', 345, 5.2, 'Rain', FALSE, FALSE, FALSE, '', 282, '2025-10-29 00:00:00'),
#             ('2025-11-06', 'Wednesday', 'November', 369, 4.6, 'Partly Cloudy', FALSE, FALSE, FALSE, '', 294, '2025-10-30 00:00:00'),
#             ('2025-11-07', 'Thursday', 'November', 348, 5.8, 'Cloudy', FALSE, FALSE, FALSE, '', 314, '2025-10-31 00:00:00'),
#             ('2025-11-08', 'Friday', 'November', 296, 4.9, 'Cloudy', FALSE, FALSE, FALSE, '', 245, '2025-11-01 00:00:00'),
#             ('2025-11-11', 'Monday', 'November', 312, 7.8, 'Fog', FALSE, FALSE, FALSE, '', 278, '2025-11-04 00:00:00'),
#             ('2025-11-12', 'Tuesday', 'November', 331, 6.0, 'Rain', FALSE, FALSE, FALSE, '', 260, '2025-11-05 00:00:00'),
#             ('2025-11-13', 'Wednesday', 'November', 329, 4.7, 'Cloudy', FALSE, FALSE, FALSE, '', 277, '2025-11-06 00:00:00'),
#             ('2025-11-14', 'Thursday', 'November', 359, 7.0, 'Partly Cloudy', FALSE, FALSE, FALSE, '', 302, '2025-11-07 00:00:00'),
#             ('2025-11-15', 'Friday', 'November', 275, 8.7, 'Cloudy', FALSE, FALSE, FALSE, '', 214, '2025-11-08 00:00:00'),
#             ('2025-11-18', 'Monday', 'November', 319, 8.5, 'Cloudy', FALSE, FALSE, FALSE, '', 268, '2025-11-11 00:00:00'),
#             ('2025-11-19', 'Tuesday', 'November', 355, 8.1, 'Cloudy', FALSE, FALSE, FALSE, '', 277, '2025-11-12 00:00:00'),
#             ('2025-11-20', 'Wednesday', 'November', 346, 3.0, 'Rain', FALSE, FALSE, FALSE, '', 283, '2025-11-13 00:00:00'),
#             ('2025-11-21', 'Thursday', 'November', 351, 5.0, 'Cloudy', FALSE, FALSE, FALSE, '', 296, '2025-11-14 00:00:00'),
#             ('2025-11-22', 'Friday', 'November', 273, 7.7, 'Partly Cloudy', FALSE, FALSE, FALSE, '', 233, '2025-11-15 00:00:00'),
#             ('2025-11-25', 'Monday', 'November', 306, 9.7, 'Rain', FALSE, FALSE, FALSE, '', 280, '2025-11-18 00:00:00'),
#             ('2025-11-26', 'Tuesday', 'November', 358, 4.6, 'Cloudy', FALSE, FALSE, FALSE, '', 269, '2025-11-19 00:00:00'),
#             ('2025-11-27', 'Wednesday', 'November', 346, 5.6, 'Cloudy', FALSE, FALSE, FALSE, '', 301, '2025-11-20 00:00:00'),
#             ('2025-11-28', 'Thursday', 'November', 350, 9.3, 'Cloudy', FALSE, FALSE, FALSE, '', 271, '2025-11-21 00:00:00'),
#             ('2025-11-29', 'Friday', 'November', 307, 7.9, 'Cloudy', FALSE, FALSE, FALSE, '', 266, '2025-11-22 00:00:00'),
#             ('2025-12-02', 'Monday', 'December', 304, 6.1, 'Rain', FALSE, FALSE, FALSE, '', 250, '2025-11-25 00:00:00'),
#             ('2025-12-03', 'Tuesday', 'December', 331, 3.6, 'Rain', FALSE, FALSE, FALSE, '', 311, '2025-11-26 00:00:00'),
#             ('2025-12-04', 'Wednesday', 'December', 369, 6.8, 'Rain', FALSE, FALSE, FALSE, '', 304, '2025-11-27 00:00:00'),
#             ('2025-12-05', 'Thursday', 'December', 358, 2.8, 'Snow', FALSE, FALSE, FALSE, '', 313, '2025-11-28 00:00:00'),
#             ('2025-12-06', 'Friday', 'December', 292, -1.2, 'Rain', FALSE, FALSE, FALSE, '', 247, '2025-11-29 00:00:00'),
#             ('2025-12-09', 'Monday', 'December', 296, 2.6, 'Cloudy', FALSE, FALSE, FALSE, '', 247, '2025-12-02 00:00:00'),
#             ('2025-12-10', 'Tuesday', 'December', 344, -0.7, 'Cloudy', FALSE, FALSE, FALSE, '', 314, '2025-12-03 00:00:00'),
#             ('2025-12-11', 'Wednesday', 'December', 370, -0.5, 'Rain', FALSE, FALSE, FALSE, '', 295, '2025-12-04 00:00:00'),
#             ('2025-12-12', 'Thursday', 'December', 309, 4.3, 'Cloudy', FALSE, FALSE, FALSE, '', 267, '2025-12-05 00:00:00'),
#             ('2025-12-13', 'Friday', 'December', 284, 5.4, 'Cloudy', FALSE, FALSE, FALSE, '', 216, '2025-12-06 00:00:00'),
#             ('2025-12-16', 'Monday', 'December', 310, 5.4, 'Snow', FALSE, FALSE, FALSE, '', 286, '2025-12-09 00:00:00'),
#             ('2025-12-17', 'Tuesday', 'December', 380, 5.0, 'Rain', FALSE, FALSE, FALSE, '', 305, '2025-12-10 00:00:00'),
#             ('2025-12-18', 'Wednesday', 'December', 315, 5.3, 'Fog', FALSE, FALSE, FALSE, '', 252, '2025-12-11 00:00:00'),
#             ('2025-12-19', 'Thursday', 'December', 321, 2.6, 'Snow', FALSE, FALSE, FALSE, '', 253, '2025-12-12 00:00:00'),
#             ('2025-12-20', 'Friday', 'December', 304, 0.2, 'Fog', FALSE, FALSE, FALSE, '', 235, '2025-12-13 00:00:00'),
#             ('2025-12-23', 'Monday', 'December', 150, -1.8, 'Cloudy', FALSE, TRUE, TRUE, '', 117, '2025-12-16 00:00:00'),
#             ('2025-12-24', 'Tuesday', 'December', 232, -1.1, 'Snow', FALSE, FALSE, TRUE, '', 200, '2025-12-17 00:00:00'),
#             ('2025-12-27', 'Friday', 'December', 150, -0.4, 'Rain', FALSE, TRUE, TRUE, '', 115, '2025-12-20 00:00:00'),
#             ('2025-12-30', 'Monday', 'December', 150, 2.8, 'Rain', FALSE, TRUE, TRUE, '', 142, '2025-12-23 00:00:00'),
#             ('2025-12-31', 'Tuesday', 'December', 188, -1.1, 'Snow', FALSE, FALSE, TRUE, '', 160, '2025-12-24 00:00:00'),
#             ('2025-01-02', 'Thursday', 'January', 215, 3.7, 'Snow', FALSE, FALSE, TRUE, '', 170, '2025-12-26 00:00:00'),
#             ('2025-01-03', 'Friday', 'January', 164, 0.5, 'Snow', FALSE, FALSE, TRUE, '', 133, '2025-12-27 00:00:00');
        
#     """))

#     session.commit()
#    # session.execute(text('DELETE FROM predictions;'))
#     #session.commit()